!function(){function e(e,t){for(var r=[];e.length;)r.push(e.splice(0,t));return r}function t(e,t,r){if("USDT"!==r)return e;return e*parseFloat(t.usdtinr.last)}let r=document.querySelector(".completed-orders");r?(r.click(),setTimeout((function(){let o=r.parentNode.parentNode.parentNode;o=o.querySelector(":scope>div:nth-child(2)>div>div>div:nth-child(3)>div>div");let n=o.querySelectorAll(":scope>div"),i="rgb(0, 200, 83)",a=Array.from(n).filter((e=>i===window.getComputedStyle(e,":before").backgroundColor));if(!a.length)return void alert("No trades found. Make sure you have made some trades in WazirX.");let l=[],s=[];a.forEach((e=>{let t=e.querySelectorAll(":scope>div:first-child>div>span:first-child");l.push(...Array.from(t))})),l.forEach((e=>{"INR"!==e.innerText.split("\n")[1]&&"USDT"!==e.innerText.split("\n")[1]||s.push(e.innerText.split("\n")[1])})),l=l.map((e=>e.innerText.split("\n")[0]));let c=e(l,4),u=["Pair","Amount","Price","Total"];elementsObjects=c.map(((e,t)=>{let r={};return e.forEach(((e,t)=>{r[u[t]]=t?parseFloat(e.replaceAll(",","")):e})),r.Currency=s[t],r}));let f=Array.from(n).filter((e=>i!==window.getComputedStyle(e,":before").backgroundColor)),d=[],p=[];f.forEach((e=>{let t=e.querySelectorAll(":scope>div:first-child>div>span:first-child");d.push(...Array.from(t))})),d.forEach((e=>{"INR"!==e.innerText.split("\n")[1]&&"USDT"!==e.innerText.split("\n")[1]||p.push(e.innerText.split("\n")[1])})),d=Array.from(d).map((e=>e.innerText.split("\n")[0]));let m=e(d,4);sellElementsObjects=m.map(((e,t)=>{let r={};return e.forEach(((e,t)=>{r[u[t]]=t?parseFloat(e.replaceAll(",","")):e})),r.Currency=p[t],r})),console.log(sellElementsObjects,elementsObjects),fetch("https://api.wazirx.com/api/v2/tickers").then((e=>e.json())).then((e=>{let r={};sellElementsObjects.forEach((o=>{"USDT"!==o.Pair&&(r.hasOwnProperty(o.Pair)||(r[o.Pair]={Amount:0,Total:0}),r[o.Pair].Amount+=o.Amount,r[o.Pair].Total+=t(o.Total,e,o.Currency))}));let o={};elementsObjects.reverse().forEach((n=>{if("USDT"!==n.Pair){if(o.hasOwnProperty(n.Pair)||(o[n.Pair]={Amount:0,Total:0,Current:t(parseFloat(e[n.Pair.toLowerCase()+n.Currency.toLowerCase()]&&e[n.Pair.toLowerCase()+n.Currency.toLowerCase()].last),e,n.Currency)}),r.hasOwnProperty(n.Pair)){let e=r[n.Pair].Amount;console.log(e,n.Amount,n.Pair,r,"SELL"),e>n.Amount?(e-=n.Amount,n.Amount=0):(n.Amount=n.Amount-e,e=0),console.log(n.Amount,"AMOUNT"),r[n.Pair].Amount=e}o[n.Pair].Amount+=n.Amount,o[n.Pair].Total+=t(n.Price*n.Amount,e,n.Currency)}}));let n={"Total Profit/Loss":0},i=[],a=["Amount","Total","Current","Price","Difference","Profit/Loss"];Object.keys(o).forEach(((e,t)=>{0===o[e].Amount?o[e].Price=0:o[e].Price=o[e].Total/o[e].Amount,o[e].Difference=o[e].Current-o[e].Price,o[e]["Profit/Loss"]=o[e].Amount*o[e].Difference,0===o[e]["Profit/Loss"]?o[e]["Percentage Profit/Loss"]=0:o[e]["Percentage Profit/Loss"]=o[e]["Profit/Loss"]/o[e].Total*100,n["Total Profit/Loss"]+=o[e]["Profit/Loss"],i.push([]),i[t].push(e),Object.keys(o[e]).forEach((r=>{o[e][r]=parseFloat(o[e][r].toFixed(4)),i[t].push(o[e][r])})),i[t].push(parseFloat(n["Total Profit/Loss"].toFixed(4)))})),a=["Pair","Amount","Total","Current","Price","Difference","Profit/Loss","Percentage Profit/Loss","Cumulative Profit/Loss"],i.unshift(a);let l=i.map((e=>e.map((e=>'"'+e+'"')).join(",")));l=l.join("\n"),function(e){window.URL=window.webkitURL||window.URL;var t="text/csv",r=new Blob([e],{type:t}),o=document.createElement("a");o.download="wazir-data-"+Date.now()+".csv",o.href=window.URL.createObjectURL(r),o.textContent="Download CSV",o.dataset.downloadurl=[t,o.download,o.href].join(":"),document.body.appendChild(o),o.click()}(l)}))}),1e3)):alert("No trades found. Make sure you are on WazirX, in the Exchange tab.")}();
